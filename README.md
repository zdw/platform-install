 CORD platform-install

This repository contains [Ansible](http://docs.ansible.com) playbooks for
installing and configuring software components that build a CORD POD:
OpenStack, ONOS, and XOS.

It is used as a sub-module of the [main CORD
repository](https://github.com/opencord/cord), but can independently bring up
various CORD profiles for development work.

If you want to set up an entire CORD pod on physical hardare, or set up the
Cord-in-a-Box deployment, you should start at the [CORD
repository](https://github.com/opencord/cord).

## Running a profile

There's a helper script that will install development environment prerequisties
on a Ubuntu 14.04 node:
[scripts/cord-bootstrap.sh](https://github.com/opencord/platform-install/blob/master/scripts/cord-bootstrap.sh).

You can download it with:

```
curl -O ~/cord-bootstrap.sh https://github.com/opencord/platform-install/raw/master/scripts/cord-bootstrap.sh
```

This will install the [repo](https://code.google.com/p/git-repo/) tool,
[Ansible](https://docs.ansible.com/ansible/index.html), and
[Docker](https://www.docker.com/), as well as make a checkout of the CORD
[manifest](https://gerrit.opencord.org/gitweb?p=manifest.git;a=blob;f=default.xml)
into `~/opencord`.

You can specify which gerrit changesets you would like repo to checkout using
the `-b` option on the script [as documented
here](https://github.com/opencord/cord/blob/master/docs/quickstart.md#using-cord-in-a-boxsh-to-download-development-code-from-gerrit).

## Credentials

Credentials will be autogenerated and placed in the `credentials/` directory
when the playbooks are run, where the credential name is the filename, and the
contents of the file is the password.

For most profiles the XOS admin user is named `xosadmin@opencord.org`.

## Using platform-install for development

### Development Loop

Most profiles are run by specifying an inventory file when running
`ansible-playbook`.  Most of the time, you want to run the `deploy-xos-playbook.yml`.

For example, to run the `frontend` config, you would run:

```
ansible-playbook -i inventory/frontend deploy-xos-playbook.yml
```

Assuming it runs without error, you can then explore the environment you've set
up.  When you're ready to tear down your environment, run:

```
ansible-playbook -i inventory/frontend teardown-playbook.yml
```

This will destroy all the docker containers created, and delete the
`~/cord_profile` directory.

You can then re-run, or run a different profile.

### Developing a new CORD profile

To create a new CORD profile, you should:

1. Create an inventory file in `inventory/` that defines the `cord_profile`
   variable, with the name of your profile.

```
[all:vars]
cord_profile=my-profile
```

2. Create a .yaml variables file in `vars/` with the name of your profile (ex:
   `my-profile.yaml`), and populate it with your configuration.

3. To test the profile, run the `deploy-xos-playbook.yml` playbook using your
   inventory profile:
   `ansible-playbook -i inventory/my-profile deploy-xos-playbook.yml`

### Making changes and lint checking your changes

Before commit, please run `./scripts/lintcheck.sh .` in the repo root, which
will perform the same lint check that Jenkins performs when in review in
Gerrit.

## Specific profiles notes

### api-test

This profile runs API tests for both the REST and TOSCA API's. This can be done
in an automated fashon

`ansible-playboook -i inventory/api-test api-test-playbook.yml`

The XOS credentials in this config are `padmin@vicci.org` and `letmein` (until
the tests are modified to support generated credentials).

### frontend

Builds a basic XOS frontend installation, useful for UI testing and
experimentation.

### mock-rcord, mock-mcord

Builds a Mock R-CORD or Mock M-CORD pod, without running service synchronizers
in a manner similar to frontend.

### opencloud

Used as a part of the [OpenCloud](http://www.opencloud.us/) deployment. Similar
to `rcord`.

### rcord

Used as a part of the [R-CORD](https://github.com/opencord/cord) deployment.
Builds infrastructure pieces like OpenStack and ONOS as well as XOS.

