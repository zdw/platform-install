---
# vars/opencloud.yaml

# site configuration
site_name: generic_opencloud
site_humanname: "Generic OpenCloud"

deployment_type: campus

keystone_admin_password: "{{ lookup('password', 'credentials/generic_opencloud_keystone_admin chars=ascii_letters,digits') }}"

xos_admin_user: xosadmin@opencord.org
xos_admin_pass: "{{ lookup('password', 'credentials/xosadmin@opencord.org chars=ascii_letters,digits') }}"
xos_admin_first: XOS
xos_admin_last: Admin

xos_users: []

# IP prefix for VMs
virt_nets:
  - name: mgmtbr
    ipv4_prefix: 192.168.250
    head_vms: true

# DNS/domain settings
site_suffix: generic.infra.opencloud.us

dns_search:
  - generic.infra.opencloud.us
  - opencloud.cs.arizona.edu

nsd_zones:
  - name: generic.infra.opencloud.us
    ipv4_first_octets: 192.168.250
    name_reverse_unbound: "168.192.in-addr.arpa"
    soa: ns1
    ns:
      - { name: ns1 }
    nodelist: head_vm_list
    aliases:
      - { name: "ns1" , dest: "head" }
      - { name: "ns" , dest: "head" }
      - { name: "apt-cache" , dest: "head" }

name_on_public_interface: head

# If true, unbound listens on the head node's `ansible_default_ipv4` interface
unbound_listen_on_default: True

# VTN network configuration
management_network_cidr: 172.27.0.0/24
management_network_ip: 172.27.0.1/24
data_plane_ip: 10.168.0.253/24


on_maas: false

run_dist_upgrade: true

openstack_version: kilo

juju_config_name: opencloud

xos_configuration: opencloud

xos_config_targets:
  - local_containers
  - xos
  - opencloud

xos_tosca_config_templates:
  - management-net.yaml
  - nodes.yaml
  - openstack.yaml
  - public-net.yaml
  - vtn.yaml

deployment_flavors:
  - m1.small
  - m1.medium
  - m1.large
  - m1.xlarge

apt_cacher_name: apt-cache

apt_ssl_sites:
  - apt.dockerproject.org
  - butler.opencloud.cs.arizona.edu
  - deb.nodesource.com

charm_versions:
  neutron-api: "cs:~cordteam/trusty/neutron-api-3"
  nova-compute: "cs:~cordteam/trusty/nova-compute-2"

head_vm_list:
  - name: "juju-1"
    service: "juju"
    aliases:
       - "juju"
    ipv4_last_octet: 10
    cpu: 1
    memMB: 2048
    diskGB: 20

  - name: "ceilometer-1"
    service: "ceilometer"
    aliases:
      - "ceilometer"
    ipv4_last_octet: 20
    cpu: 1
    memMB: 2048
    diskGB: 20
    forwarded_ports:
      - { ext: 8777, int: 8777 }

  - name: "glance-1"
    service: "glance"
    aliases:
      - "glance"
    ipv4_last_octet: 30
    cpu: 2
    memMB: 4096
    diskGB: 160
    forwarded_ports:
      - { ext: 9292, int: 9292 }

  - name: "keystone-1"
    service: "keystone"
    aliases:
      - "keystone"
    ipv4_last_octet: 40
    cpu: 2
    memMB: 4096
    diskGB: 40
    forwarded_ports:
      - { ext: 35357, int: 35357 }
      - { ext: 4990, int: 4990 }
      - { ext: 5000, int: 5000 }

  - name: "percona-cluster-1"
    service: "percona-cluster"
    aliases:
      - "percona-cluster"
    ipv4_last_octet: 50
    cpu: 2
    memMB: 4096
    diskGB: 40

  - name: "nagios-1"
    service: "nagios"
    aliases:
      - "nagios"
    ipv4_last_octet: 60
    cpu: 1
    memMB: 2048
    diskGB: 20
    forwarded_ports:
      - { ext: 3128, int: 80 }

  - name: "neutron-api-1"
    service: "neutron-api"
    aliases:
      - "neutron-api"
    ipv4_last_octet: 70
    cpu: 2
    memMB: 4096
    diskGB: 40
    forwarded_ports:
      - { ext: 9696, int: 9696 }


  - name: "nova-cloud-controller-1"
    service: "nova-cloud-controller"
    aliases:
      - "nova-cloud-controller"
    ipv4_last_octet: 90
    cpu: 2
    memMB: 4096
    diskGB: 40
    forwarded_ports:
      - { ext: 8774, int: 8774 }

  - name: "openstack-dashboard-1"
    service: "openstack-dashboard"
    aliases:
      - "openstack-dashboard"
    ipv4_last_octet: 100
    cpu: 1
    memMB: 2048
    diskGB: 20
    forwarded_ports:
      - { ext: 8080, int: 80 }

  - name: "rabbitmq-server-1"
    service: "rabbitmq-server"
    aliases:
      - "rabbitmq-server"
    ipv4_last_octet: 110
    cpu: 2
    memMB: 4096
    diskGB: 40

  - name: "onos-cord-1"
    aliases:
      - "onos-cord"
    ipv4_last_octet: 110
    cpu: 2
    memMB: 4096
    diskGB: 40
    docker_path: "cord"

  - name: "xos-1"
    aliases:
      - "xos"
    ipv4_last_octet: 130
    cpu: 2
    memMB: 4096
    diskGB: 40
    docker_path: 'service-profile/opencloud'

vm_service_list:
  - ceilometer
  - glance
  - keystone
  - nagios
  - neutron-api
  - nova-cloud-controller
  - openstack-dashboard
  - percona-cluster
  - rabbitmq-server

standalone_service_list:
  - ceilometer-agent
  - nrpe
  - ntp

service_relations:
  - name: keystone
    relations: [ "percona-cluster", "nrpe", ]

  - name: nova-cloud-controller
    relations: [ "percona-cluster", "rabbitmq-server", "glance", "keystone", "nrpe", ]

  - name: glance
    relations: [ "percona-cluster", "keystone", "nrpe", ]

  - name: neutron-api
    relations: [ "keystone", "percona-cluster", "rabbitmq-server", "nova-cloud-controller", "nrpe", ]

  - name: openstack-dashboard
    relations: [ "keystone", "nrpe", ]

  - name: nagios
    relations: [ "nrpe", ]

  - name: "percona-cluster:juju-info"
    relations: [ "nrpe:general-info", ]

  - name: rabbitmq-server
    relations: [ "nrpe", ]

  - name: ceilometer
    relations: [ "mongodb", "rabbitmq-server", "nagios", "nrpe", ]

  - name: "ceilometer:identity-service"
    relations: [ "keystone:identity-service", ]

  - name: "ceilometer:ceilometer-service"
    relations: [ "ceilometer-agent:ceilometer-service", ]


compute_relations:
  - name: nova-compute
    relations: [ "ceilometer-agent", "glance", "nova-cloud-controller", "nagios", "nrpe", ]

  - name: "nova-compute:shared-db"
    relations: [ "percona-cluster:shared-db", ]

  - name: "nova-compute:amqp"
    relations: [ "rabbitmq-server:amqp", ]

  - name: ntp
    relations: [ "nova-compute", ]


xos_images:
  - name: "trusty-server-multi-nic"
    url: "http://www.vicci.org/opencloud/trusty-server-cloudimg-amd64-disk1.img"
    checksum: "sha256:c2d0ffc937aeb96016164881052a496658efeb98959dc68e73d9895c5d9920f7"

